<?xml version="1.0" encoding="UTF-8"?>

<xwikidoc version="1.3" reference="BachelorsAndMastersManagement.Note.Raport" locale="">
  <web>BachelorsAndMastersManagement.Note</web>
  <name>Raport</name>
  <language/>
  <defaultLanguage></defaultLanguage>
  <translation>0</translation>
  <creator>xwiki:XWiki.Admin</creator>
  <creationDate>1356998400000</creationDate>
  <parent>Main.WebHome</parent>
  <author>xwiki:XWiki.Admin</author>
  <contentAuthor>xwiki:XWiki.Admin</contentAuthor>
  <date>1356998400000</date>
  <contentUpdateDate>1356998400000</contentUpdateDate>
  <version>1.1</version>
  <title>Raport</title>
  <comment/>
  <minorEdit>false</minorEdit>
  <syntaxId>xwiki/2.1</syntaxId>
  <hidden>false</hidden>
  <content>{{velocity}}
#set($Integer = 0)

#set($objectPage = "BachelorsAndMastersManagement.Note.Code.NotaObjects")
#set($MyDoc = $xwiki.getDocument($objectPage))

#set($probe = [])
#set($note = {})
#foreach($nota in $MyDoc.getObjects("BachelorsAndMastersManagement.Note.Code.NotaClass"))
  #if(!$note.containsKey($nota.student))
    #set($note[$nota.student] = [])
  #end
  #set($discard = $note[$nota.student].add($nota))
  #if(!$probe.contains($nota.proba))
    #set($discard = $probe.add($nota.proba))
  #end
#end
#set($discard = $probe.sort())

|=Student#foreach($proba in $probe)|=$proba#end|=Observatii
#foreach($pair in $note.entrySet())
  #set($numNote = {})
  #set($sumNote = {})
  #foreach($nota in $pair.value)
    #if(!$numNote.containsKey($nota.proba))
      #set($numNote[$nota.proba] = 0)
      #set($sumNote[$nota.proba] = 0)
    #end
    #set($numNote[$nota.proba] = $numNote[$nota.proba] + 1)
    #set($sumNote[$nota.proba] = $sumNote[$nota.proba] + $Integer.parseInt($nota.nota, 10))
  #end
  ##
  #set($medii = {})
  #set($minMedie = 1000)
  #foreach($proba in $numNote.entrySet())
    #set($medie = $sumNote[$proba.key] * 100 / $proba.value)
    #if($medie &lt; $minMedie)
      #set($minMedie = $medie)
    #end
    #set($medii[$proba.key] = $numbertool.format("#0,00", $medie))
  #end
  ##
  #if($minMedie &gt;= 500 &amp;&amp; $medii.size() == $probe.size())
    #set($observatii = "promovat")
  #else
    #set($observatii = "nepromovat")
  #end
  ##
  |$pair.key#foreach($proba in $probe)|$medii.getOrDefault($proba, "-")#end|$observatii
#end
{{/velocity}}
</content>
</xwikidoc>
